<!DOCTYPE html>
<!--
To change this license header, choose License Headers in Project Properties.
To change this template file, choose Tools | Templates
and open the template in the editor.
-->
<html>
    <head>
        
        <meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>jQuery Mobile Bootstrap Theme</title>
<link rel="stylesheet" href="themes/Bootstrap.css">
<link rel="stylesheet" href="http://code.jquery.com/mobile/1.4.0/jquery.mobile.structure-1.4.0.min.css" />
<link rel="stylesheet" href="themes/jquery.mobile.icons.min.css" />
<script src="http://code.jquery.com/jquery-1.8.2.min.js"></script>
<script src="http://code.jquery.com/mobile/1.4.0/jquery.mobile-1.4.0.min.js"></script>
<script type="text/javascript" src="phonegap-1.4.1.js"></script>
<script type="text/javascript" charset="utf-8" src="cordova.js"></script>
<script type="text/javascript">

function checkdata(){
    
//    document.addEventListener("deviceready",onDeviceReady,true);
//            var db;
//            function onDeviceReady(){
//                db=window.openDatabase("portanatura","1.0","Product",2*1024*1024);
//                db.transaction(createDB,errorCB,successCB);                                
//            }
jQuery(document).ready(function(){
    var db;
    db=window.openDatabase("portanatura","1.0","product",2*1024*1024);
    db.transaction(createDB,errorCB,successCB); 
    function createDB(tx){
                tx.executeSql('DROP TABLE IF EXISTS product');
                tx.executeSql('CREATE TABLE IF NOT EXISTS product(product_id INTEGER PRIMARY KEY AUTOINCREMENT,product_name TEXT,category_id INTEGER,category_name TEXT,   TEXT)');
                
                console.log("Create  database");
            }
            function errorCB(err){
                alert("Error processing sql"+err.code);
            }
            function successCB(){
                alert("YEAH!!!!");
                //insertDB();
            }
            
   
var data = {
                    'action':'getProductCategories',
                    'somethingimportant':'whatissoimportant',
                    'format':'json'            
                };
                jQuery.ajax({
                url: 'http://portanaturasi.com/wp-admin/admin-ajax.php',
                data: data,
                type: 'GET',
                dataType: 'json',
                success: function(data){
                    console.log(data);

                    var number_of_post = data.length;
                        alert(number_of_post);
                    
                                        //var pimage = "my image";
                                        //alert(ptitle +","+ pdate +","+ pccount+","+ pcategories +","+ pimage);
                                        db.transaction(function(transaction) {
                                            for(var i=0; i < number_of_post; i++){

                                        var ptitle = data[i].title;
                                        var pdate = data[i].date;
                                        var pccount = data[i].comment_count;
                                        var pcontent = data[i].content;
                                        var pcategories = data[i].categories;
                                            transaction.executeSql('INSERT INTO product(product_id,product_name,category_id,category_name,primary_category) VALUES (?,?,?,?,?)',[ptitle,pdate,pccount,pcontent,pcategories]);
                                       
                                            } 
                                             alert("data inserted")
                    });

                }
            });
        });
    }

</script>

    </head>
    <body>
        <div class="ui-body ui-body-d">

            <div class="ui-block-d"><button id="categories" type="button" data-theme="d" data-icon="arrow-r" data-iconpos="right" onclick="loaddata();">Get Categories</button></div>
<div class="ui-block-d"><button id="categories" type="button" data-theme="d" data-icon="arrow-r" data-iconpos="right" onclick="insertDB();">Save Data</button></div>
<div class="ui-block-d"><button id="categories" type="button" data-theme="d" data-icon="arrow-r" data-iconpos="right" onclick="getresult();">Get Result</button></div>
<div class="ui-block-d"><button id="categories" type="button" data-theme="d" data-icon="arrow-r" data-iconpos="right" onclick="checkdata();">check Result</button></div>
<br>
<br>
<br>
<table id="data" ></table>
<div id="dialog" title="Cookie Monster Says"></div>
<script type="text/javascript" src="load-data.js"></script>
<script type="text/javascript" src="app.js"></script>
<script type="text/javascript" src="getresult.js"></script>

</div>

    </body>
</html>
