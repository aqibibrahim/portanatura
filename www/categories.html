<!DOCTYPE html>
<!--
To change this license header, choose License Headers in Project Properties.
To change this template file, choose Tools | Templates
and open the template in the editor.
-->
<html>
    <head>
        
        <meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>jQuery Mobile Bootstrap Theme</title>
<link rel="stylesheet" href="themes/Bootstrap.css">
<link rel="stylesheet" href="http://code.jquery.com/mobile/1.4.0/jquery.mobile.structure-1.4.0.min.css" />
<link rel="stylesheet" href="themes/jquery.mobile.icons.min.css" />
<script src="http://code.jquery.com/jquery-1.8.2.min.js"></script>
<script src="http://code.jquery.com/mobile/1.4.0/jquery.mobile-1.4.0.min.js"></script>
<script type="text/javascript" src="phonegap-1.4.1.js"></script>
<script type="text/javascript" charset="utf-8" src="cordova.js"></script>
<script type="text/javascript">

function checkdata(){
    
    var db;
    db=window.openDatabase("portanatura","1.0","product",2*1024*1024);
    db.transaction(createDB,errorCB,successCB); 
    function createDB(tx){
		//tx.executeSql('DROP TABLE IF EXISTS product_aqi');
		tx.executeSql('CREATE TABLE IF NOT EXISTS product_aqi(product_id INTEGER,product_name TEXT,category_id INTEGER,category_name TEXT,  primary_category TEXT)');
		
		alert("Create database");
	}
	function errorCB(err){
		alert("Error processing sql"+err.code);
	}
	function successCB(){
		alert("YEAH!!!!");	
	}            
	var data = {
		'action':'getProductCategories',
		'somethingimportant':'whatissoimportant',
		'format':'json'            
	}
	jQuery.ajax({
		url: 'http://portanaturasi.com/wp-admin/admin-ajax.php',
		data: data,
		type: 'GET',
		dataType: 'json',
		success: function(data1){                    

			var number_of_post = data1.length;
			number_of_post=3;                        
                        for(var i=0; i < number_of_post; i++){

                                ContentValues cv = new ContentValues();
                                cv.put("product_id", data1[i][0]);
                                cv.put("product_name", data1[i][1]);
                                cv.put("category_id", data1[i][2]);
                                cv.put("category_name", data1[i][3]);
                                cv.put("primary_category", null);                                            

                           db.insert("product_aqi",null,cv);
                        }
                        alert("data completely inserted");
		}
	});
        
}

</script>
<script type="text/javascript">
    function myFunction() {
//            $('#data tr').each(function() {
//    var customerId = $(this).find('td').html(); 
//    alert(customerId);
// });

            $("#data tr").click(function(){
                
        var $tds = $(this).find('td'),
            productId = $tds.eq(0).text(),
            product = $tds.eq(1).text(),
            category_id = $tds.eq(2).text();
            category_name=$tds.eq(3).text();
            primary_category=$tds.eq(4).text();
            alert('Row :\nId: ' + productId
              + '\nProduct: ' + product
              + '\nCategory Id: ' + category_id
              + '\nCategory Name: ' + category_name
              + '\nPrimary Category: ' + primary_category);
      
		});
        // do 
    

        }
</script>
<script type="text/javascript">
    function extractFromDB(){
     var db = window.openDatabase("portanatura", "1.0", "product", true);
     db.transaction(queryDB, errorCB);


  function queryDB(tx) {
     tx.executeSql('SELECT count(*) FROM product_aqi', [], querySuccess, errorCB);
 }
function errorCB(err){
                alert("Error processing sql"+err.code);
            }
 function querySuccess(tx, results) {
     var len = results.rows.length;
     console.log("DEMO table: " + len + " rows found.");
     alert(len);
//     for (var i=0; i<len; i++){
//            console.log("Row = " + i + " ID = " + results.rows.item(i).id + " Data =  " + results.rows.item(i).data);
//      }
}
    }
 
</script>

    </head>
    <body>
        <div class="ui-body ui-body-d">

            <div class="ui-block-d"><button id="categories" type="button" data-theme="d" data-icon="arrow-r" data-iconpos="right" onclick="loaddata();">Get Categories</button></div>
<div class="ui-block-d"><button id="categories" type="button" data-theme="d" data-icon="arrow-r" data-iconpos="right" onclick="insertDB();">Save Data</button></div>
<div class="ui-block-d"><button id="categories" type="button" data-theme="d" data-icon="arrow-r" data-iconpos="right" onclick="extractFromDB();">Get Result</button></div>
<div class="ui-block-d"><button id="categories" type="button" data-theme="d" data-icon="arrow-r" data-iconpos="right" onclick="checkdata();">check Result</button></div>
<a href="display.tml">Display Records</a>
<br>
<br>
<br>
<table id="data" ></table>
<div id="dialog" title="Cookie Monster Says"></div>
<script type="text/javascript" src="load-data.js"></script>
<script type="text/javascript" src="app.js"></script>


</div>

    </body>
</html>
